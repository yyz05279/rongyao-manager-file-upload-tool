# 快速开始指南

## 🚀 5 分钟上手

### 第一步：安装依赖

打开终端（Terminal），进入项目目录，执行：

```bash
cd "/Users/yyz/Desktop/熔盐管理文件上传工具"
pip3 install -r requirements.txt
```

### 第二步：运行程序

```bash
python3 main.py
```

### 第三步：使用程序

1. **登录**

   - 服务器地址：`http://42.192.76.234:8081
`（或实际服务器地址）
   - 输入用户名和密码
   - 点击"登录"

2. **上传文件**
   - 选择项目
   - 点击"添加文件"，选择 Excel 文件
   - 点击"开始上传"
   - 等待上传完成

## 📦 打包为应用程序

### macOS 系统

```bash
# 使用打包脚本（已优化）
./build_macos.sh

# 如果需要调试
./build_macos_debug.sh
```

打包完成后，应用程序位于：`dist/熔盐管理文件上传工具.app`

### Windows 系统

双击运行：`build_windows.bat`

或在命令行执行：

```cmd
build_windows.bat
```

打包完成后，可执行文件位于：`dist\熔盐管理文件上传工具.exe`

## 🔧 常见问题

### 问题 1：找不到 openpyxl 模块

**解决**：

```bash
pip3 install openpyxl
```

### 问题 2：找不到 PyQt6 模块

**解决**：

```bash
pip3 install PyQt6
```

### 问题 3：无法连接服务器

**检查**：

- 服务器是否运行？
- 网络是否通畅？
- 服务器地址是否正确？

### 问题 4：macOS 提示"无法打开"

**解决**：

```bash
xattr -cr "dist/熔盐管理文件上传工具.app"
```

然后再双击运行。

## 📝 技术方案说明

### 为什么选择 PyQt6？

| 方案         | 优势                                                                       | 劣势                                 | 结论     |
| ------------ | -------------------------------------------------------------------------- | ------------------------------------ | -------- |
| **PyQt6** ✅ | • 直接复用现有 Python 代码<br>• 跨平台支持好<br>• 打包简单<br>• 开发效率高 | • 程序体积较大                       | **推荐** |
| Electron     | • 跨平台<br>• 界面美观                                                     | • 需要重写 Python 代码<br>• 体积更大 | 不推荐   |
| Tauri        | • 体积小<br>• 性能好                                                       | • 需要学习 Rust<br>• 开发周期长      | 不推荐   |

### 核心功能

1. **用户认证** - 支持 JWT Token 登录
2. **文件解析** - 自动解析 Excel 日报文件
3. **数据转换** - 转换为 API 格式
4. **批量上传** - 调用后端 API 批量导入
5. **进度显示** - 实时显示上传进度

### 项目架构

```
┌─────────────────────────────────────────┐
│           GUI Layer (PyQt6)             │
│  ┌─────────────┐    ┌─────────────┐    │
│  │ LoginWidget │    │UploadWidget │    │
│  └──────┬──────┘    └──────┬──────┘    │
└─────────┼───────────────────┼───────────┘
          │                   │
┌─────────┼───────────────────┼───────────┐
│         │   Service Layer   │           │
│  ┌──────▼────────┐   ┌──────▼────────┐ │
│  │  AuthService  │   │ UploadService │ │
│  └───────────────┘   └───────┬───────┘ │
└──────────────────────────────┼─────────┘
                               │
┌──────────────────────────────┼─────────┐
│         Data Processing      │         │
│  ┌────────────────────────┐  │         │
│  │ Excel Parser           │◄─┘         │
│  │ + Format Converter     │            │
│  └────────────────────────┘            │
└────────────────────────────────────────┘
                 │
                 ▼
         ┌───────────────┐
         │  Backend API  │
         └───────────────┘
```

## 🎯 下一步优化建议

### 功能增强

- [ ] 支持拖拽上传文件
- [ ] 支持批量上传多个文件
- [ ] 添加上传历史记录
- [ ] 支持断点续传
- [ ] 添加自动更新功能

### 界面优化

- [ ] 添加应用图标
- [ ] 支持深色模式
- [ ] 添加动画效果
- [ ] 优化加载状态显示

### 性能优化

- [ ] 使用线程池处理并发上传
- [ ] 添加文件缓存机制
- [ ] 优化大文件解析性能

## 📞 获取帮助

遇到问题？请查看：

1. [完整文档](README.md)
2. [API 文档](api/19-项目日报批量导入API.md)
3. 联系开发团队

---

**祝使用愉快！** 🎉
